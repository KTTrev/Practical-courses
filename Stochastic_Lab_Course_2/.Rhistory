#Use appropriate graphical tools to check if the Weibull model is adequate for the data
plot(log(-log(km)), log(0:90))
km$surv
#Use appropriate graphical tools to check if the Weibull model is adequate for the data
plot(log(-log(km$surv)), log(0:90))
#Use appropriate graphical tools to check if the Weibull model is adequate for the data
plot(log(-log(km$surv)), log(0:45))
#Use appropriate graphical tools to check if the Weibull model is adequate for the data
plot(log(-log(km$surv)), log(1:45))
#Use appropriate graphical tools to check if the Weibull model is adequate for the data
plot(log(-log(km$surv)), log(1:45))
abline(a = -log(lam_hat), b = alpha )
?abline
km$surv
#Use appropriate graphical tools to check if the Weibull model is adequate for the data
plot(log(1:45), log(-log(km$surv)))
abline(a = -log(lam_hat), b = alpha )
abline(a = -log(lam_hat), b = alpha )
#Use appropriate graphical tools to check if the Weibull model is adequate for the data
plot(log(1:45), log(-log(km$surv)))
abline(a = -log(lam_hat), b = alpha )
#Use appropriate graphical tools to check if the Weibull model is adequate for the data
plot(log(-log(km$surv)), log(1:45))
abline(a = -log(lam_hat), b = alpha )
alpha
lam_hat <- exp(-wei_fit$coefficients)
#Use appropriate graphical tools to check if the Weibull model is adequate for the data
plot(log(-log(km$surv)), log(1:45))
abline(a = -log(lam_hat), b = alpha )
#Use appropriate graphical tools to check if the Weibull model is adequate for the data
plot(log(-log(fh$surv)), log(1:45))
abline(a = -log(lam_hat), b = alpha )
#Use appropriate graphical tools to check if the Weibull model is adequate for the data
plot(log(-log(km$surv)), log(1:45))
abline(a = -log(lam_hat), b = alpha )
nrow(thor)
unique(thor$AGE)
#Kaplan-Meier estimators for each group
km_smoker_fit <- survfit(Surv(AGE, Risk1Y) ~ PRE30, data = thor)
#plot on one plot together with the corresponding confidence bands
autoplot(km_smoker_fit) +
ggtitle("Smokers based Survival") +
labs(x = "Time", y = "Survival Probability") +
guides(fill=FALSE) +
labs(colour = "Smoker")
#Fit the Weibull model to both groups
wei_smoker_fit <- survreg(Surv(AGE, Risk1Y) ~ PRE30, data = thor, dist="weibull")
wei_smoker_fit$scale
wei_smoker_fit$df.residual
wei_smoker_fit
#Fit the Weibull model to both groups
wei_smoker_fit <- survreg(Surv(AGE, Risk1Y) ~ c(T, T), data = thor, dist="weibull")
c(T, T)
#Fit the Weibull model to both groups
wei_smoker_fit <- survreg(Surv(AGE, Risk1Y) ~ PRE30, data = thor, dist="weibull")
?survreg
#Fit the Weibull model to both groups
wei_smoker_fit <- survreg(Surv(AGE, Risk1Y) ~ PRE30, data = thor, dist="weibull", scale <= 0)
#Fit the Weibull model to both groups
wei_smoker_fit <- survreg(Surv(AGE, Risk1Y) ~ PRE30, data = thor, dist="weibull", scale = 0)
wei_smoker_fit$scale
wei_smoker_fit
#Use appropriate graphical tools to check if the Weibull model is adequate for the data
plot(log(-log(km$surv)), log(1:45))
abline(a = -log(lam_hat), b = alpha )
#Use appropriate graphical tools to check if the Weibull model is adequate for the data
plot(log(1:45) ,log(-log(km$surv)))
abline(a = -log(lam_hat), b = alpha )
abline(a = -log(lam_hat), b = alpha )
lam_hat <- exp(-exp_fit$coefficients)
#Use appropriate graphical tools to check if the Weibull model is adequate for the data
plot(log(1:45) ,log(-log(km$surv)))
abline(a = -log(lam_hat), b = alpha )
#Use appropriate graphical tools to check if the Weibull model is adequate for the data
plot(log(km$time) ,log(-log(km$surv)))
abline(a = -log(lam_hat), b = alpha )
abline(a = -log(lam_hat), b = alpha )
abline(a = alpha*log(lam_hat), b = alpha )
#Use appropriate graphical tools to check if the Weibull model is adequate for the data
plot(log(km$time) ,log(-log(km$surv)))
abline(a = alpha*log(lam_hat), b = alpha )
lam_hat <- exp(-wei_fit$coefficients)
lam_hat
#Use appropriate graphical tools to check if the Weibull model is adequate for the data
plot(log(km$time) ,log(-log(km$surv)))
abline(a = alpha*log(lam_hat), b = alpha )
library("tidyverse")
library("survival")
library(ggfortify) #for the function autoplot for objects of type survfit
thor <- read.delim("Thoracic.txt", sep = " ")
thor <- thor %>%
dplyr::select(c(T.2, X60, F.7))
colnames(thor) <- c("PRE30", "AGE", "Risk1Y")
#Question(a)
#Computing nonparametric estimators of the survivor function: Kaplan-Meier
km <- survfit(Surv(AGE, Risk1Y) ~ 1, data = thor, type = "kaplan-meier")
#Computing nonparametric estimators of the survivor function: Flemming-Harrington
fh <- survfit(Surv(AGE, Risk1Y) ~ 1, data = thor, type = "fleming-harrington")
#plot of km and fh
plot(km, col = "blue")
lines(fh, col='red')
legend( par("usr")[2], par("usr")[4], yjust=3, xjust=1.6,
c("Kaplan-Meier", "Fleming-Harrington"),
lwd=c(1,1), lty=c(1,1),
col=c("blue", 'red'))
title(main="nonparametric estimators of the survivor function")
#fit the exponential model to the data
exp_fit <- survreg(Surv(AGE, Risk1Y) ~ 1, data = thor, dist="exponential")
lam_hat_exp <- exp(-exp_fit$coefficients)
fit.dat.exp <- exp(-lam_hat_exp*c(0:90))
#fit the Weibull model to the data
wei_fit <- survreg(Surv(AGE, Risk1Y) ~ 1, data = thor, dist="weibull")
lam_hat_wei <- exp(-wei_fit$coefficients)
alpha <- 1/wei_fit$scale
fit.dat.wei <- exp(-(lam_hat_wei*c(0:90))^alpha)
#plot
plot(km, col = "blue")
lines(fh, col='red')
lines(fit.dat.exp, col = "green")
lines(fit.dat.wei, col = "black")
legend("bottomleft", inset=.02,
legend =  c("Kaplan-Meier", "Fleming-Harrington", "Exponential", "Weibull"),
col =  c("blue", "red", "green", "black"),
lwd=c(1,1), lty=c(1,1),
box.lty=0)
title(main="nonparametric & parametric estimators \n of the survivor function")
#Use appropriate graphical tools to check if the Weibull model is adequate for the data
plot(log(km$time) ,log(-log(km$surv)))
abline(a = alpha*log(lam_hat_wei), b = alpha )
#Question(b)
#How large is the proportion of smokers in the sample
sum(thor$PRE30)/nrow(thor)
km$time
abline(a = alpha*log(lam_hat_wei), b = alpha, col = "blue" )
#Use appropriate graphical tools to check if the Weibull model is adequate for the data
plot(log(km$time) ,log(-log(km$surv)), col = "green")
abline(a = alpha*log(lam_hat_wei), b = alpha, col = "blue" )
#Use appropriate graphical tools to check if the Weibull model is adequate for the data
plot(log(km$time) ,log(-log(km$surv)), col = "red")
abline(a = alpha*log(lam_hat_wei), b = alpha, col = "blue" )
#Use appropriate graphical tools to check if the Weibull model is adequate for the data
plot(log(km$time) ,-log(km$surv), col = "red")
abline(a = alpha*log(lam_hat_wei), b = alpha, col = "blue" )
#Use appropriate graphical tools to check if the Weibull model is adequate for the data
plot(log(km$time) ,log(-log(km$surv)), col = "red")
abline(a = alpha*log(lam_hat_wei), b = alpha, col = "blue" )
abline(a = alpha*log(lam_hat_wei), b = alpha, col = "blue" )
#Fit the Weibull model to both groups
wei_smokers_fit <- survreg(Surv(AGE, Risk1Y) ~ PRE30, data = thor, dist="weibull", scale = 0)
#Fit the Weibull model to both groups
wei_smokers_fit <- survreg(Surv(AGE, Risk1Y) ~ PRE30, data = thor, dist="weibull", scale = 0)
?survreg
?dplyr::select
autoplot(km_smoker_fit) +
ggtitle("Smokers based Survival") +
labs(x = "Time", y = "Survival Probability") +
guides(fill=FALSE) +
labs(colour = "Smoker")
#Fit the Weibull model to both groups
wei_smokers_fit <- survreg(Surv(AGE, Risk1Y) ~ PRE30, data = thor, dist="weibull", scale = 0)
wei_smokers_fit$scale
wei_smokers_fit$coefficients
?filter
thor %>%
filter(PRE30 == T)
filter(PRE30 == F)
thor %>%
filter(PRE30 == T)
thor %>%
filter(PRE30 == F)
c(1, 3, 5, 5, 1, 2, 2, 2, 3 , 5)
a <- c(1, 3, 5, 5, 1, 2, 2, 2, 3 , 5)
a %>%
filter( a==1)
thor.smokers <- thor %>%
select(c(PRE30, AGE, Risk1Y))
thor.smokers <- thor %>%
select(c(PRE30, AGE, Risk1Y)) %>%
filter(PRE30 == "TRUE")
thor.smokers
head(thor.smokers)
nrow(thor.smokers)
thor.smokers <- thor %>%
filter(PRE30 == "TRUE")
nrow(thor.smokers)
thor.nonsmokers <- thor %>%
filter(PRE30 == "FALSE")
nrow(thor.nonsmokers)
wei_smokers_fit <- survreg(Surv(AGE, Risk1Y) ~ PRE30, data = thor.smokers, dist="weibull")
wei_nonsmokers_fit <- survreg(Surv(AGE, Risk1Y) ~ PRE30, data = thor.nonsmokers, dist="weibull")
alpha_smokers <- 1/wei_smokers_fit$scale
fit.dat.wei.smokers <- exp(-(lam_hat_wei*c(0:90))^alpha)
thor.smokers <- thor %>%
filter(PRE30 == "TRUE")
thor.nonsmokers <- thor %>%
filter(PRE30 == "FALSE")
#fitting the Weibull model to smokers' group
wei_smokers_fit <- survreg(Surv(AGE, Risk1Y) ~ PRE30, data = thor.smokers, dist="weibull")
lam_hat_wei_smokers <- exp(-wei_smokers_fit$coefficients)
alpha_smokers <- 1/wei_smokers_fit$scale
fit.dat.wei.smokers <- exp(-(lam_hat_wei_smokers*c(0:90))^alpha)
#fitting the Weibull model to nonsmokers' group
wei_nonsmokers_fit <- survreg(Surv(AGE, Risk1Y) ~ PRE30, data = thor.nonsmokers, dist="weibull")
lam_hat_wei_nonsmokers <- exp(-wei_nonsmokers_fit$coefficients)
alpha_nonsmokers <- 1/wei_nonsmokers_fit$scale
lam_hat_wei_smokers
#fitting the Weibull model to smokers' group
wei_smokers_fit <- survreg(Surv(AGE, Risk1Y) ~ PRE30, data = thor.smokers, dist="weibull")
lam_hat_wei_smokers <- exp(-wei_smokers_fit$coefficients)
alpha_smokers <- 1/wei_smokers_fit$scale
fit.dat.wei.smokers <- exp(-(lam_hat_wei_smokers*c(0:90))^alpha)
#fitting the Weibull model to nonsmokers' group
wei_nonsmokers_fit <- survreg(Surv(AGE, Risk1Y) ~ PRE30, data = thor.nonsmokers, dist="weibull")
lam_hat_wei_nonsmokers <- exp(-wei_nonsmokers_fit$coefficients)
alpha_nonsmokers <- 1/wei_nonsmokers_fit$scale
fit.dat.wei.nonsmokers <- exp(-(lam_hat_wei_smokers*c(0:90))^alpha)
fit.dat.wei.nonsmokers
#fit the Weibull model to the data
wei_fit <- survreg(Surv(AGE, Risk1Y) ~ 1, data = thor, dist="weibull")
lam_hat_wei <- exp(-wei_fit$coefficients)
alpha <- 1/wei_fit$scale
fit.dat.wei <- exp(-(lam_hat_wei*c(0:90))^alpha)
fit.dat.wei
#fitting the Weibull model to nonsmokers' group
wei_nonsmokers_fit <- survreg(Surv(AGE, Risk1Y) ~ PRE30, data = thor.nonsmokers, dist="weibull")
lam_hat_wei_nonsmokers <- exp(-wei_nonsmokers_fit$coefficients)
alpha_nonsmokers <- 1/wei_nonsmokers_fit$scale
fit.dat.wei.nonsmokers <- exp(-(lam_hat_wei_smokers*c(0:90))^alpha)
#plot
plot(wei_smokers_fit, col = "blue")
#plot
plot(fit.dat.wei.smokers, col = "blue")
lines(fit.dat.wei.nonsmokers, col='red')
#fit the exponential model to the data
exp_fit <- survreg(Surv(AGE, Risk1Y) ~ 1, data = thor, dist="exponential")
lam_hat_exp <- exp(-exp_fit$coefficients)
fit.dat.exp <- exp(-lam_hat_exp*km$time)
#fit the Weibull model to the data
wei_fit <- survreg(Surv(AGE, Risk1Y) ~ 1, data = thor, dist="weibull")
lam_hat_wei <- exp(-wei_fit$coefficients)
alpha <- 1/wei_fit$scale
fit.dat.wei <- exp(-(lam_hat_wei*km$time)^alpha)
#plot
plot(km, col = "blue")
lines(fh, col='red')
lines(fit.dat.exp, col = "green")
lines(fit.dat.wei, col = "black")
fit.dat.wei.smokers <- exp(-(lam_hat_wei_smokers*c(0:90))^alpha)
fit.dat.wei.nonsmokers <- exp(-(lam_hat_wei_smokers*c(0:90))^alpha)
#plot
plot(fit.dat.wei.smokers, col = "blue")
lines(fit.dat.wei.nonsmokers, col='red')
fit.dat.exp <- exp(-lam_hat_exp*c(0:90))
fit.dat.wei <- exp(-(lam_hat_wei*c(0:90))^alpha)
#plot
plot(km, col = "blue")
lines(fh, col='red')
lines(fit.dat.exp, col = "green")
lines(fit.dat.wei, col = "black")
#Computing nonparametric estimators of the survivor function: Kaplan-Meier
km_smokers <- survfit(Surv(AGE, Risk1Y) ~ PRE30, data = thor.smokers, type = "kaplan-meier")
km_nonsmokers <- survfit(Surv(AGE, Risk1Y) ~ PRE30, data = thor.nonsmokers, type = "kaplan-meier")
#plot
plot(fit.dat.wei.smokers, col = "blue")
lines(fit.dat.wei.nonsmokers, col='red')
lines(km_smokers, col='red')
#plot
plot(fit.dat.wei.smokers, col = "blue")
lines(fit.dat.wei.nonsmokers, col='red')
lines(km_smokers, col = "green")
lines(km_nonsmokers, col = "black")
#Computing nonparametric estimators of the survivor function: Kaplan-Meier
km_smokers <- survfit(Surv(AGE, Risk1Y) ~ PRE30, data = thor.smokers, type = "kaplan-meier")
km_nonsmokers <- survfit(Surv(AGE, Risk1Y) ~ PRE30, data = thor.nonsmokers, type = "kaplan-meier")
fit.dat.wei.smokers <- exp(-(lam_hat_wei_smokers*km_smokers$time)^alpha)
fit.dat.wei.nonsmokers <- exp(-(lam_hat_wei_smokers*km_nonsmokers)^alpha)
#plot
plot(fit.dat.wei.smokers, col = "blue")
lines(fit.dat.wei.nonsmokers, col='red')
lines(km_smokers, col = "green")
lines(km_nonsmokers, col = "black")
fit.dat.wei.nonsmokers <- exp(-(lam_hat_wei_smokers*km_nonsmokers$time)^alpha)
#plot
plot(fit.dat.wei.smokers, col = "blue")
lines(fit.dat.wei.nonsmokers, col='red')
lines(km_smokers, col = "green")
lines(km_nonsmokers, col = "black")
fit.dat.wei.smokers <- exp(-(lam_hat_wei_smokers*c(0:90))^alpha)
#fitting the Weibull model to smokers' group
wei_smokers_fit <- survreg(Surv(AGE, Risk1Y) ~ PRE30, data = thor.smokers, dist="weibull")
lam_hat_wei_smokers <- exp(-wei_smokers_fit$coefficients)
alpha_smokers <- 1/wei_smokers_fit$scale
fit.dat.wei.smokers <- exp(-(lam_hat_wei_smokers*c(0:90))^alpha)
#fitting the Weibull model to nonsmokers' group
wei_nonsmokers_fit <- survreg(Surv(AGE, Risk1Y) ~ PRE30, data = thor.nonsmokers, dist="weibull")
lam_hat_wei_nonsmokers <- exp(-wei_nonsmokers_fit$coefficients)
alpha_nonsmokers <- 1/wei_nonsmokers_fit$scale
fit.dat.wei.nonsmokers <- exp(-(lam_hat_wei_smokers*c(0:90))^alpha)
#Computing nonparametric estimators of the survivor function: Kaplan-Meier
km_smokers <- survfit(Surv(AGE, Risk1Y) ~ PRE30, data = thor.smokers, type = "kaplan-meier")
km_nonsmokers <- survfit(Surv(AGE, Risk1Y) ~ PRE30, data = thor.nonsmokers, type = "kaplan-meier")
#plot
plot(fit.dat.wei.smokers, col = "blue")
lines(fit.dat.wei.nonsmokers, col='red')
lines(km_smokers, col = "green")
lines(km_nonsmokers, col = "black")
legend("bottomleft", inset=.02,
legend =  c("Kaplan-Meier", "Fleming-Harrington", "Exponential", "Weibull"),
col =  c("blue", "red", "green", "black"),
lwd=c(1,1), lty=c(1,1),
box.lty=0)
#plot
plot(fit.dat.wei.smokers, col = "blue")
lines(fit.dat.wei.nonsmokers, col='red')
lines(km_smokers, col = "green")
lines(km_nonsmokers, col = "black")
fit.dat.wei.smokers <- exp(-(lam_hat_wei_smokers*c(0:90))^alpha_smokers)
fit.dat.wei.nonsmokers <- exp(-(lam_hat_wei_smokers*c(0:90))^alpha_nonsmokers)
#plot
plot(fit.dat.wei.smokers, col = "blue")
lines(fit.dat.wei.nonsmokers, col='red')
lines(km_smokers, col = "green")
alpha_smokers
alpha_nonsmokers
alpha
fit.dat.wei.nonsmokers <- exp(-(lam_hat_wei_nonsmokers*c(0:90))^alpha_nonsmokers)
#plot
plot(fit.dat.wei.smokers, col = "blue")
lines(fit.dat.wei.nonsmokers, col='red')
lines(km_smokers, col = "green")
lines(km_nonsmokers, col = "black")
?plot
#plot
plot(fit.dat.wei.smokers, col = "blue", type = "l")
lines(fit.dat.wei.nonsmokers, col='red')
lines(km_smokers, col = "green")
lines(km_nonsmokers, col = "black")
#Use appropriate graphical tools to check if the Weibull model is adequate for the data
plot(log(km$time) ,log(-log(km$surv)), col = "red", ttype = "l")
abline(a = alpha*log(lam_hat_wei), b = alpha, col = "blue" )
#Use appropriate graphical tools to check if the Weibull model is adequate for the data
plot(log(km$time) ,log(-log(km$surv)), col = "red", type = "l")
abline(a = alpha*log(lam_hat_wei), b = alpha, col = "blue" )
#Use appropriate graphical tools to check if the Weibull model is adequate for the data
plot(log(km$time) ,log(-log(km$surv)), col = "red", type = "b")
abline(a = alpha*log(lam_hat_wei), b = alpha, col = "blue" )
#Use appropriate graphical tools to check if the Weibull model is adequate for the data
plot(log(km$time) ,log(-log(km$surv)), col = "red")
abline(a = alpha*log(lam_hat_wei), b = alpha, col = "blue" )
#plot
plot(fit.dat.wei.smokers, col = "blue", type = "l")
lines(fit.dat.wei.nonsmokers, col='red')
lines(km_smokers, col = "green")
lines(km_nonsmokers, col = "black")
legend("bottomleft", inset=.02,
legend =  c("Kaplan-Meier", "Fleming-Harrington", "Exponential", "Weibull"),
col =  c("blue", "red", "green", "black"),
lwd=c(1,1), lty=c(1,1),
box.lty=0)
#plot
plot(fit.dat.wei.smokers, col = "blue", type = "l")
lines(fit.dat.wei.nonsmokers, col='red')
lines(km_smokers, col = "green")
lines(km_nonsmokers, col = "black")
legend("bottomleft", inset=.02,
legend =  c("Weibull smokers", "Weibull nonsmokers", "km smokers", "km nonsmokers"),
col =  c("blue", "red", "green", "black"),
lwd=c(1,1), lty=c(1,1),
box.lty=0)
legend("bottomleft", inset=.02,
legend =  c("Weibull smokers", "Weibull nonsmokers", "km smokers", "km nonsmokers"),
col =  c("blue", "red", "green", "black"),
lwd=c(0,1), lty=c(1,1),
box.lty=0)
legend("bottomleft", inset=.02,
legend =  c("Weibull smokers", "Weibull nonsmokers", "km smokers", "km nonsmokers"),
col =  c("blue", "red", "green", "black"),
lwd=c(1,1), lty=c(10,1),
box.lty=0)
#plot
plot(fit.dat.wei.smokers, col = "blue", type = "l")
lines(fit.dat.wei.nonsmokers, col='red')
lines(km_smokers, col = "green")
lines(km_nonsmokers, col = "black")
legend("bottomleft", inset=.02,
legend =  c("Weibull smokers", "Weibull nonsmokers", "km smokers", "km nonsmokers"),
col =  c("blue", "red", "green", "black"),
lwd=c(1,1), lty=c(1,1),
box.lty=0)
autoplot(fit.dat.wei.smokers)
plot(fit.dat.wei.smokers)
fit.dat.wei.smokers
unique(thor.smokers)
unique(thor.nonsmokers$AGE)
c(0:90)
fit.dat.wei.nonsmokers <- exp(-(lam_hat_wei_nonsmokers*c(0:90))^alpha_nonsmokers)
#plot
plot(fit.dat.wei.smokers, col = "blue", type = "l")
lines(fit.dat.wei.nonsmokers, col='red')
unique(thor.smokers$AGE)
fit.dat.wei.smokers <- exp(-(lam_hat_wei_smokers*unique(thor.smokers$AGE))^alpha_smokers)
#fitting the Weibull model to nonsmokers' group
wei_nonsmokers_fit <- survreg(Surv(AGE, Risk1Y) ~ PRE30, data = thor.nonsmokers, dist="weibull")
lam_hat_wei_nonsmokers <- exp(-wei_nonsmokers_fit$coefficients)
alpha_nonsmokers <- 1/wei_nonsmokers_fit$scale
fit.dat.wei.nonsmokers <- exp(-(lam_hat_wei_nonsmokers*c(0:90))^alpha_nonsmokers)
#Computing nonparametric estimators of the survivor function: Kaplan-Meier
km_smokers <- survfit(Surv(AGE, Risk1Y) ~ PRE30, data = thor.smokers, type = "kaplan-meier")
km_nonsmokers <- survfit(Surv(AGE, Risk1Y) ~ PRE30, data = thor.nonsmokers, type = "kaplan-meier")
#plot
plot(fit.dat.wei.smokers, col = "blue", type = "l")
lines(fit.dat.wei.nonsmokers, col='red')
lines(km_smokers, col = "green")
lines(km_nonsmokers, col = "black")
#fitting the Weibull model to smokers' group
wei_smokers_fit <- survreg(Surv(AGE, Risk1Y) ~ PRE30, data = thor.smokers, dist="weibull")
lam_hat_wei_smokers <- exp(-wei_smokers_fit$coefficients)
alpha_smokers <- 1/wei_smokers_fit$scale
fit.dat.wei.smokers <- exp(-(lam_hat_wei_smokers*c(0:90))^alpha_smokers)
#fitting the Weibull model to nonsmokers' group
wei_nonsmokers_fit <- survreg(Surv(AGE, Risk1Y) ~ PRE30, data = thor.nonsmokers, dist="weibull")
lam_hat_wei_nonsmokers <- exp(-wei_nonsmokers_fit$coefficients)
alpha_nonsmokers <- 1/wei_nonsmokers_fit$scale
fit.dat.wei.nonsmokers <- exp(-(lam_hat_wei_nonsmokers*c(0:90))^alpha_nonsmokers)
#Computing nonparametric estimators of the survivor function: Kaplan-Meier
km_smokers <- survfit(Surv(AGE, Risk1Y) ~ PRE30, data = thor.smokers, type = "kaplan-meier")
km_nonsmokers <- survfit(Surv(AGE, Risk1Y) ~ PRE30, data = thor.nonsmokers, type = "kaplan-meier")
#plot
plot(fit.dat.wei.smokers, col = "blue", type = "l")
lines(fit.dat.wei.nonsmokers, col='red')
lines(km_smokers, col = "green")
lines(km_nonsmokers, col = "black")
legend("bottomleft", inset=.02,
legend =  c("Weibull smokers", "Weibull nonsmokers", "km smokers", "km nonsmokers"),
col =  c("blue", "red", "green", "black"),
lwd=c(1,1), lty=c(1,1),
box.lty=0)
legend("bottomleft", inset=.01,
legend =  c("Weibull smokers", "Weibull nonsmokers", "km smokers", "km nonsmokers"),
col =  c("blue", "red", "green", "black"),
lwd=c(1,1), lty=c(1,1),
box.lty=0)
legend("bottomleft", inset=.001,
legend =  c("Weibull smokers", "Weibull nonsmokers", "km smokers", "km nonsmokers"),
col =  c("blue", "red", "green", "black"),
lwd=c(1,1), lty=c(1,1),
box.lty=0)
legend("bottomleft", inset=.0001,
legend =  c("Weibull smokers", "Weibull nonsmokers", "km smokers", "km nonsmokers"),
col =  c("blue", "red", "green", "black"),
lwd=c(1,1), lty=c(1,1),
box.lty=0)
#fitting the Weibull model to nonsmokers' group
wei_nonsmokers_fit <- survreg(Surv(AGE, Risk1Y) ~ 1, data = thor.nonsmokers, dist="weibull")
lam_hat_wei_nonsmokers <- exp(-wei_nonsmokers_fit$coefficients)
alpha_nonsmokers <- 1/wei_nonsmokers_fit$scale
fit.dat.wei.nonsmokers <- exp(-(lam_hat_wei_nonsmokers*c(0:90))^alpha_nonsmokers)
#Computing nonparametric estimators of the survivor function: Kaplan-Meier
km_smokers <- survfit(Surv(AGE, Risk1Y) ~ PRE30, data = thor.smokers, type = "kaplan-meier")
km_nonsmokers <- survfit(Surv(AGE, Risk1Y) ~ PRE30, data = thor.nonsmokers, type = "kaplan-meier")
#plot
plot(fit.dat.wei.smokers, col = "blue", type = "l")
lines(fit.dat.wei.nonsmokers, col='red')
lines(km_smokers, col = "green")
#fitting the Weibull model to smokers' group
wei_smokers_fit <- survreg(Surv(AGE, Risk1Y) ~ 1, data = thor.smokers, dist="weibull")
lam_hat_wei_smokers <- exp(-wei_smokers_fit$coefficients)
alpha_smokers <- 1/wei_smokers_fit$scale
fit.dat.wei.smokers <- exp(-(lam_hat_wei_smokers*c(0:90))^alpha_smokers)
#fitting the Weibull model to nonsmokers' group
wei_nonsmokers_fit <- survreg(Surv(AGE, Risk1Y) ~ 1, data = thor.nonsmokers, dist="weibull")
lam_hat_wei_nonsmokers <- exp(-wei_nonsmokers_fit$coefficients)
alpha_nonsmokers <- 1/wei_nonsmokers_fit$scale
fit.dat.wei.nonsmokers <- exp(-(lam_hat_wei_nonsmokers*c(0:90))^alpha_nonsmokers)
#Computing nonparametric estimators of the survivor function: Kaplan-Meier
km_smokers <- survfit(Surv(AGE, Risk1Y) ~ PRE30, data = thor.smokers, type = "kaplan-meier")
km_nonsmokers <- survfit(Surv(AGE, Risk1Y) ~ PRE30, data = thor.nonsmokers, type = "kaplan-meier")
#plot
plot(fit.dat.wei.smokers, col = "blue", type = "l")
lines(fit.dat.wei.nonsmokers, col='red')
lines(km_smokers, col = "green")
lines(km_nonsmokers, col = "black")
legend("bottomleft", inset=.0001,
legend =  c("Weibull smokers", "Weibull nonsmokers", "km smokers", "km nonsmokers"),
col =  c("blue", "red", "green", "black"),
lwd=c(1,1), lty=c(1,1),
box.lty=0)
title(main="nonparametric & parametric estimators \n of the survivor function by group")
max(thor.nonsmokers)
#Is the Weibull model an appropriate assumption in both groups
plot(log(km_smokers$time) ,log(-log(km_smokers$surv)), col = "red")
abline(a = alpha_smokers*log(lam_hat_wei_smokers), b = alpha, col = "blue" )
#Is the Weibull model an appropriate assumption in both groups
plot(log(km_smokers$time) ,log(-log(km_smokers$surv)), col = "red")
abline(a = alpha_smokers*log(lam_hat_wei_smokers), b = alpha, col = "blue" )
plot(log(km_nonsmokers$time) ,log(-log(km_nonsmokers$surv)), col = "red")
abline(a = alpha_nonsmokers*log(lam_hat_wei_nonsmokers), b = alpha, col = "blue" )
abline(a = alpha_nonsmokers*log(lam_hat_wei_nonsmokers), b = alpha_nonsmokers, col = "blue" )
#Is the Weibull model an appropriate assumption in both groups
plot(log(km_smokers$time) ,log(-log(km_smokers$surv)), col = "red")
abline(a = alpha_smokers*log(lam_hat_wei_smokers), b = alpha_smokers, col = "blue" )
plot(log(km_nonsmokers$time) ,log(-log(km_nonsmokers$surv)), col = "red")
abline(a = alpha_nonsmokers*log(lam_hat_wei_nonsmokers), b = alpha_nonsmokers, col = "blue" )
title(main="Checking Weibull if weibull is appropriate for smokers' group")
#Is the Weibull model an appropriate assumption in both groups
plot(log(km_smokers$time) ,log(-log(km_smokers$surv)), col = "red")
abline(a = alpha_smokers*log(lam_hat_wei_smokers), b = alpha_smokers, col = "blue" )
title(main="Checking Weibull if weibull is appropriate for smokers' group")
title(main="Checking Weibull if weibull is appropriate \n for smokers' group")
plot(log(km_nonsmokers$time) ,log(-log(km_nonsmokers$surv)), col = "red")
abline(a = alpha_nonsmokers*log(lam_hat_wei_nonsmokers), b = alpha_nonsmokers, col = "blue" )
title(main="Checking Weibull if weibull is appropriate \n for nonsmokers' group")
